# åšå®¢ç³»ç»Ÿ API æ–‡æ¡£

> åŸºç¡€åœ°å€ï¼š`http://127.0.0.1:5000`

---

## ğŸ“Œ é€šç”¨è¯´æ˜

### è¯·æ±‚æ ¼å¼
- Content-Type: `application/json`

### è®¤è¯æ–¹å¼
éœ€è¦ç™»å½•çš„æ¥å£ï¼Œè¯·åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ï¼š
```
Authorization: Bearer <token>
```

### ç»Ÿä¸€é”™è¯¯å“åº”
```json
{
    "error": "é”™è¯¯æè¿°ä¿¡æ¯"
}
```

### HTTP çŠ¶æ€ç 
| çŠ¶æ€ç  | å«ä¹‰ |
|--------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 201 | åˆ›å»ºæˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªç™»å½• |
| 403 | æ— æƒé™ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## ğŸ¥ å¥åº·æ£€æŸ¥

### GET /api/health
æ£€æµ‹æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
    "status": "ok",
    "message": "åšå®¢ç³»ç»Ÿ API è¿è¡Œæ­£å¸¸"
}
```

---

## ğŸ‘¤ ç”¨æˆ·æ¨¡å—

### POST /api/users/register
ç”¨æˆ·æ³¨å†Œã€‚

**è¯·æ±‚ä½“ï¼š**
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| username | string | âœ… | ç”¨æˆ·åï¼ˆ2~50å­—ç¬¦ï¼Œå­—æ¯/æ•°å­—/ä¸‹åˆ’çº¿/ä¸­æ–‡ï¼‰ |
| email | string | âœ… | é‚®ç®± |
| password | string | âœ… | å¯†ç ï¼ˆ6~128å­—ç¬¦ï¼‰ |

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
    "username": "zhangsan",
    "email": "zhangsan@example.com",
    "password": "123456"
}
```

**æˆåŠŸå“åº” (201)ï¼š**
```json
{
    "message": "æ³¨å†ŒæˆåŠŸ",
    "user": {
        "id": 1,
        "username": "zhangsan",
        "email": "zhangsan@example.com"
    }
}
```

**å¯èƒ½çš„é”™è¯¯ï¼š**
- 400ï¼šç”¨æˆ·å/é‚®ç®±/å¯†ç æ ¼å¼ä¸æ­£ç¡®
- 400ï¼šç”¨æˆ·åå·²è¢«æ³¨å†Œ
- 400ï¼šé‚®ç®±å·²è¢«æ³¨å†Œ

---

### POST /api/users/login
ç”¨æˆ·ç™»å½•ï¼Œè¿”å› JWT Tokenã€‚

**è¯·æ±‚ä½“ï¼š**
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| email | string | äºŒé€‰ä¸€ | é‚®ç®±ç™»å½• |
| username | string | äºŒé€‰ä¸€ | ç”¨æˆ·åç™»å½• |
| password | string | âœ… | å¯†ç  |

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
    "email": "zhangsan@example.com",
    "password": "123456"
}
```

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
    "message": "ç™»å½•æˆåŠŸ",
    "token": "eyJ0eXAiOiJKV1QiLCJhbGci...",
    "user": {
        "id": 1,
        "username": "zhangsan",
        "email": "zhangsan@example.com"
    }
}
```

**å¯èƒ½çš„é”™è¯¯ï¼š**
- 400ï¼šå¯†ç ä¸æ­£ç¡®
- 404ï¼šç”¨æˆ·ä¸å­˜åœ¨

---

## ğŸ“ æ–‡ç« æ¨¡å—

### POST /api/posts ğŸ”’
åˆ›å»ºæ–‡ç« ï¼ˆéœ€è¦ç™»å½•ï¼‰ã€‚

**è¯·æ±‚å¤´ï¼š** `Authorization: Bearer <token>`

**è¯·æ±‚ä½“ï¼š**
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| title | string | âœ… | æ–‡ç« æ ‡é¢˜ï¼ˆ1~200å­—ç¬¦ï¼‰ |
| content | string | âœ… | æ–‡ç« å†…å®¹ |

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
    "title": "æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ",
    "content": "è¿™æ˜¯æ–‡ç« çš„å†…å®¹..."
}
```

**æˆåŠŸå“åº” (201)ï¼š**
```json
{
    "message": "åˆ›å»ºæ–‡ç« æˆåŠŸ",
    "post": {
        "id": 1,
        "title": "æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« ",
        "content": "è¿™æ˜¯æ–‡ç« çš„å†…å®¹...",
        "author_id": 1,
        "created_at": "2026-02-09T10:00:00",
        "updated_at": "2026-02-09T10:00:00"
    }
}
```

---

### GET /api/posts
è·å–æ–‡ç« åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µï¼‰ã€‚

**æŸ¥è¯¢å‚æ•°ï¼š**
| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| page | int | 1 | é¡µç  |
| per_page | int | 10 | æ¯é¡µæ•°é‡ |

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```
GET /api/posts?page=1&per_page=5
```

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
    "message": "è·å–æ–‡ç« æˆåŠŸ",
    "count": 15,
    "page": 1,
    "per_page": 5,
    "total_pages": 3,
    "posts": [
        {
            "id": 1,
            "title": "æ–‡ç« æ ‡é¢˜",
            "content": "æ–‡ç« å†…å®¹",
            "author_id": 1,
            "created_at": "2026-02-09T10:00:00",
            "updated_at": "2026-02-09T10:00:00"
        }
    ]
}
```

---

### GET /api/posts/:post_id
è·å–æ–‡ç« è¯¦æƒ…ã€‚

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
    "id": 1,
    "title": "æ–‡ç« æ ‡é¢˜",
    "content": "æ–‡ç« å†…å®¹",
    "author_id": 1,
    "created_at": "2026-02-09T10:00:00",
    "updated_at": "2026-02-09T10:00:00"
}
```

**å¯èƒ½çš„é”™è¯¯ï¼š**
- 404ï¼šæ–‡ç« ä¸å­˜åœ¨

---

### PUT /api/posts/:post_id ğŸ”’
æ›´æ–°æ–‡ç« ï¼ˆéœ€è¦ç™»å½•ï¼Œåªèƒ½æ›´æ–°è‡ªå·±çš„æ–‡ç« ï¼‰ã€‚

**è¯·æ±‚å¤´ï¼š** `Authorization: Bearer <token>`

**è¯·æ±‚ä½“ï¼š**
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| title | string | âœ… | æ–°æ ‡é¢˜ï¼ˆ1~200å­—ç¬¦ï¼‰ |
| content | string | âœ… | æ–°å†…å®¹ |

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
    "message": "æ›´æ–°æ–‡ç« æˆåŠŸ",
    "post": { ... }
}
```

**å¯èƒ½çš„é”™è¯¯ï¼š**
- 401ï¼šæœªç™»å½•
- 403ï¼šæ— æƒä¿®æ”¹æ­¤æ–‡ç« 
- 404ï¼šæ–‡ç« ä¸å­˜åœ¨

---

### DELETE /api/posts/:post_id ğŸ”’
åˆ é™¤æ–‡ç« ï¼ˆéœ€è¦ç™»å½•ï¼Œåªèƒ½åˆ é™¤è‡ªå·±çš„æ–‡ç« ï¼‰ã€‚

**è¯·æ±‚å¤´ï¼š** `Authorization: Bearer <token>`

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
    "message": "åˆ é™¤æ–‡ç« æˆåŠŸ"
}
```

**å¯èƒ½çš„é”™è¯¯ï¼š**
- 401ï¼šæœªç™»å½•
- 403ï¼šæ— æƒåˆ é™¤æ­¤æ–‡ç« 
- 404ï¼šæ–‡ç« ä¸å­˜åœ¨

---

## ğŸ’¬ è¯„è®ºæ¨¡å—

### POST /api/posts/:post_id/comments ğŸ”’
åˆ›å»ºè¯„è®ºï¼ˆéœ€è¦ç™»å½•ï¼‰ã€‚

**è¯·æ±‚å¤´ï¼š** `Authorization: Bearer <token>`

**è¯·æ±‚ä½“ï¼š**
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| content | string | âœ… | è¯„è®ºå†…å®¹ï¼ˆ1~1000å­—ç¬¦ï¼‰ |

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
    "content": "å†™å¾—çœŸå¥½ï¼"
}
```

**æˆåŠŸå“åº” (201)ï¼š**
```json
{
    "message": "åˆ›å»ºè¯„è®ºæˆåŠŸ",
    "comment": {
        "id": 1,
        "content": "å†™å¾—çœŸå¥½ï¼",
        "post_id": 1,
        "author_id": 2,
        "created_at": "2026-02-09T10:30:00",
        "updated_at": "2026-02-09T10:30:00",
        "author": {
            "id": 2,
            "username": "lisi"
        }
    }
}
```

---

### GET /api/posts/:post_id/comments
è·å–æ–‡ç« çš„æ‰€æœ‰è¯„è®ºã€‚

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
    "message": "è·å–è¯„è®ºæˆåŠŸ",
    "count": 3,
    "comments": [ ... ]
}
```

---

### PUT /api/posts/comments/:comment_id ğŸ”’
æ›´æ–°è¯„è®ºï¼ˆéœ€è¦ç™»å½•ï¼Œåªèƒ½æ›´æ–°è‡ªå·±çš„è¯„è®ºï¼‰ã€‚

**è¯·æ±‚å¤´ï¼š** `Authorization: Bearer <token>`

**è¯·æ±‚ä½“ï¼š**
| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| content | string | âœ… | æ–°è¯„è®ºå†…å®¹ï¼ˆ1~1000å­—ç¬¦ï¼‰ |

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
    "message": "æ›´æ–°è¯„è®ºæˆåŠŸ",
    "comment": { ... }
}
```

**å¯èƒ½çš„é”™è¯¯ï¼š**
- 401ï¼šæœªç™»å½•
- 403ï¼šæ— æƒä¿®æ”¹æ­¤è¯„è®º
- 404ï¼šè¯„è®ºä¸å­˜åœ¨

---

### DELETE /api/posts/comments/:comment_id ğŸ”’
åˆ é™¤è¯„è®ºï¼ˆéœ€è¦ç™»å½•ï¼Œåªèƒ½åˆ é™¤è‡ªå·±çš„è¯„è®ºï¼‰ã€‚

**è¯·æ±‚å¤´ï¼š** `Authorization: Bearer <token>`

**æˆåŠŸå“åº” (200)ï¼š**
```json
{
    "message": "åˆ é™¤è¯„è®ºæˆåŠŸ"
}
```

**å¯èƒ½çš„é”™è¯¯ï¼š**
- 401ï¼šæœªç™»å½•
- 403ï¼šæ— æƒåˆ é™¤æ­¤è¯„è®º
- 404ï¼šè¯„è®ºä¸å­˜åœ¨

---

## ğŸ”‘ æ¥å£æƒé™æ€»ç»“

| æ¥å£ | æ–¹æ³• | éœ€è¦ç™»å½• | æƒé™æ§åˆ¶ |
|------|------|----------|----------|
| /api/health | GET | âŒ | æ—  |
| /api/users/register | POST | âŒ | æ—  |
| /api/users/login | POST | âŒ | æ—  |
| /api/posts | GET | âŒ | æ—  |
| /api/posts/:id | GET | âŒ | æ—  |
| /api/posts | POST | âœ… | æ—  |
| /api/posts/:id | PUT | âœ… | åªèƒ½æ”¹è‡ªå·±çš„ |
| /api/posts/:id | DELETE | âœ… | åªèƒ½åˆ è‡ªå·±çš„ |
| /api/posts/:id/comments | GET | âŒ | æ—  |
| /api/posts/:id/comments | POST | âœ… | æ—  |
| /api/posts/comments/:id | PUT | âœ… | åªèƒ½æ”¹è‡ªå·±çš„ |
| /api/posts/comments/:id | DELETE | âœ… | åªèƒ½åˆ è‡ªå·±çš„ |

> ğŸ”’ = éœ€è¦åœ¨è¯·æ±‚å¤´æºå¸¦ Token
